 // json source file generated by excel
var _AUCUN = "---- Aucun ----";
var _SRC = [];
var _YEAR = new Date().toLocaleDateString().split('/').reverse()[0];
var _DATAS = {};
var _DEBUG = true;
var _PASSPORT = undefined;
var _MODE = "new" | "add" | "edit" | "edits" | "none";
var rpgReferences = {};
// authorized columns
const _EXCELCOLS = [ "programme", "echantillon", "site", "responsable", "pays", "region", "pointx", "pointy", "prelevement", "peremption", "libre"];

// test if key in url
isKeyInUrl= (keyName) => window.location.href.includes(`?${keyName}=`) || window.location.href.includes(`&${keyName}=`);

if(window.location.href.includes('?id=') || window.location.href.includes('&id='));

// return key vlaue number
function getNumberFromUrl(keyName) {
    const tmp = window.location.href.split('?')[1].split("&").filter(key =>  key.includes(keyName+'='))[0];
    return +tmp.split(`=`)[1] || 0;
}

formatDate = (input) => input && input.includes("T") && input.includes("-") ? input.split("T")[0].split("-").reverse().join('-') : input;


function createBlankKeySticker(name, value) {
    return {
        "key": value || "type",
        "align": "center",
        "size": "12px"
    }
}

function getTemplateSticker() {
  return {
    etiquette : getElement("etiquette").value ? JSON.parse(getElement("etiquette").value) : _CONFIGURATION.etiquette,
    "type":"Sol",
    "programme":"Programme concerné",
    "site":"Nom du site",
    "responsable":"ADAM Mario",
    "pays":"France",
    "region":"Bretagne",
    "identification":"1902202617320002",
    "prelevement":"01-01-2026",
    "peremption":"01-01-2031",
    "libre":"Texte libre limité à 50 caractères"
  };
}

function changeValueInJson(name, key, value) {
    const tmp = toJson(name);
    if (typeof key === "string")
        tmp[key] = value;
    else 
        tmp[key[0]][key[1]] = value;
    getElement(name).value = JSON.stringify(tmp);
};











    